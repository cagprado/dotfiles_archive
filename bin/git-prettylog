#!/bin/sh

fmt='Ë‡%C(3 bold)%h%C(r)~%s~%C(5 bold)%cr%C(r)Ë‡%C(auto)Ë‡%DË‡%C(r)'
fil=$(cat <<-'__END__'
	function graph(s) {
	  sub("[|].*/", "â”œâ”€â•¯",          s)
	  sub("[|]",    "â”‚",            s)
	  sub("[*]",    "[31mâ”œ[m",  s)
	  return s
	}
	{
	  $1 = graph($1)
	  if ($4 == "") {
	    print $1$2
	  } else {
	    $4 = $1 "~" $3 $4 $5
	    sub(" .*â”œ", "", $4)
	    sub("â”œ", NR==1 ? "" : "â”‚", $4)
	    print $4 "\n" $1 $2
	  }
	}
	__END__
)

git log --all --color --graph --pretty="$fmt" | awk -FË‡ "$fil" | column -ts~
