# vim: ft=sh:
# X configuration file

export DE="generic"
export QT_QPA_PLATFORMTHEME=qt5ct
export FREETYPE_PROPERTIES="truetype:interpreter-version=38"
export _JAVA_OPTIONS="-Dswing.defaultlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel -Dswing.crossplatformlaf=com.sun.java.swing.plaf.gtk.GTKLookAndFeel -Djdk.gtk.version=3 -Dawt.useSystemAAFontSettings=on -Dswing.aatext=true -Dsun.java2d.opengl=true"

# Set keyboard and IM
xkbcomp -I$HOME/.config/xkb $HOME/.config/xkb/custom.xkb $DISPLAY
export GTK_IM_MODULE=fcitx
export QT_IM_MODULE=fcitx
export XMODIFIERS=@im=fcitx

# Setup screens
xset s off -dpms
export HIDPI=$($HOME/bin/setmonitors)

# Set cursor theme
echo "Xcursor.theme: capitaine-cursors" >> $HOME/.Xresources

# Tune DPI scaling
if [ "${HIDPI}" = true ]; then
    # set cursor size
    echo "Xcursor.size: 48" >> $HOME/.Xresources

    # set scale of common GUI toolkits
    export GDK_SCALE=2
    export GDK_DPI_SCALE=0.5
    export QT_AUTO_SCREEN_SCALE_FACTOR=0
    export QT_SCREEN_SCALE_FACTORS=2

    # GTK2 does not support scaling: set manually tuned HiDPI theme
    export GTK2_RC_FILES=$HOME/.config/gtkrc-2.0-HiDPI
else
    # set cursor size
    echo "Xcursor.size: 32" >> $HOME/.Xresources

    # use subpixel for non-HiDPI monitors
    export FT2_SUBPIXEL_HINTING=2

    # set scale of common GUI toolkits
    export GDK_SCALE=1
    export GDK_DPI_SCALE=1
    export QT_AUTO_SCREEN_SCALE_FACTOR=0
    export QT_SCREEN_SCALE_FACTORS=1

    # Set default GTK2 theme
    export GTK2_RC_FILES=$HOME/.config/gtkrc-2.0
fi
